<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Johnson-Neyman intervals for 2-way interactions — johnson_neyman • interactions</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.9/font.css" rel="stylesheet"><link href="../deps/IBM_Plex_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Raleway-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate Johnson-Neyman intervals for 2-way interactions — johnson_neyman"><meta name="description" content='johnson_neyman finds so-called "Johnson-Neyman" intervals for
understanding where simple slopes are significant in the context of
interactions in multiple linear regression.'><meta property="og:description" content='johnson_neyman finds so-called "Johnson-Neyman" intervals for
understanding where simple slopes are significant in the context of
interactions in multiple linear regression.'><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">interactions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Documentation</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/interactions.html">Exploring interactions with continuous predictors in regression models</a></li>
    <li><a class="dropdown-item" href="../articles/categorical.html">Plotting interactions among categorical variables in regression models</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jacob-long/interactions"><span class="fa fa-github fa-lg"></span> Github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Johnson-Neyman intervals for 2-way interactions</h1>
      <small class="dont-index">Source: <a href="https://github.com/jacob-long/interactions/blob/master/R/johnson_neyman.R" class="external-link"><code>R/johnson_neyman.R</code></a></small>
      <div class="d-none name"><code>johnson_neyman.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>johnson_neyman</code> finds so-called "Johnson-Neyman" intervals for
understanding where simple slopes are significant in the context of
interactions in multiple linear regression.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">johnson_neyman</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">pred</span>,</span>
<span>  <span class="va">modx</span>,</span>
<span>  vmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control.fdr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  line.thickness <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  df <span class="op">=</span> <span class="st">"residual"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"jtools-digits"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  critical.t <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig.color <span class="op">=</span> <span class="st">"#00BFC4"</span>,</span>
<span>  insig.color <span class="op">=</span> <span class="st">"#F8766D"</span>,</span>
<span>  mod.range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Johnson-Neyman plot"</span>,</span>
<span>  y.label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  modx.label <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A regression model. It is tested with <code>lm</code>, <code>glm</code>, and
<code>svyglm</code> objects, but others may work as well. It should contain the
interaction of interest. Be aware that just because the computations
work, this does not necessarily mean the procedure is appropriate for
the type of model you have.</p></dd>


<dt id="arg-pred">pred<a class="anchor" aria-label="anchor" href="#arg-pred"></a></dt>
<dd><p>The predictor variable involved in the interaction.</p></dd>


<dt id="arg-modx">modx<a class="anchor" aria-label="anchor" href="#arg-modx"></a></dt>
<dd><p>The moderator variable involved in the interaction.</p></dd>


<dt id="arg-vmat">vmat<a class="anchor" aria-label="anchor" href="#arg-vmat"></a></dt>
<dd><p>Optional. You may supply the variance-covariance matrix of the
coefficients yourself. This is useful if you are using robust standard
errors, as you could if using the <span class="pkg">sandwich</span> package.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The alpha level. By default, the standard 0.05.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Should a plot of the results be printed? Default is <code>TRUE</code>.
The <code>ggplot2</code> object is returned either way.</p></dd>


<dt id="arg-control-fdr">control.fdr<a class="anchor" aria-label="anchor" href="#arg-control-fdr"></a></dt>
<dd><p>Logical. Use the procedure described in Esarey &amp; Sumner
(2017) to limit the false discovery rate? Default is FALSE. See details
for more on this method.</p></dd>


<dt id="arg-line-thickness">line.thickness<a class="anchor" aria-label="anchor" href="#arg-line-thickness"></a></dt>
<dd><p>How thick should the predicted line be? This is
passed to <code>geom_path</code> as the <code>size</code> argument, but because of the way the
line is created, you cannot use <code>geom_path</code> to modify the output plot
yourself.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>How should the degrees of freedom be calculated for the critical
test statistic? Previous versions used the large sample approximation; if
alpha was .05, the critical test statistic was 1.96 regardless of sample
size and model complexity. The default is now "residual", meaning the same
degrees of freedom used to calculate p values for regression coefficients.
You may instead choose any number or "normal", which reverts to the
previous behavior. The argument is not used if <code>control.fdr = TRUE</code>.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>An integer specifying the number of digits past the decimal to
report in the output. Default is 2. You can change the default number of
digits for all jtools functions with
<code>options("jtools-digits" = digits)</code> where digits is the desired
number.</p></dd>


<dt id="arg-critical-t">critical.t<a class="anchor" aria-label="anchor" href="#arg-critical-t"></a></dt>
<dd><p>If you want to provide the critical test statistic instead
relying on a normal or <em>t</em> approximation, or the <code>control.fdr</code> calculation,
you can give that value here. This allows you to use other methods for
calculating it.</p></dd>


<dt id="arg-sig-color">sig.color<a class="anchor" aria-label="anchor" href="#arg-sig-color"></a></dt>
<dd><p>Sets the color for areas of the Johnson-Neyman plot where
the slope of the moderator is significant at the specified level. <code>"black"</code>
can be a good choice for greyscale publishing.</p></dd>


<dt id="arg-insig-color">insig.color<a class="anchor" aria-label="anchor" href="#arg-insig-color"></a></dt>
<dd><p>Sets the color for areas of the Johnson-Neyman plot where
the slope of the moderator is insignificant at the specified level. <code>"grey"</code>
can be a good choice for greyscale publishing.</p></dd>


<dt id="arg-mod-range">mod.range<a class="anchor" aria-label="anchor" href="#arg-mod-range"></a></dt>
<dd><p>The range of values of the moderator (the x-axis) to plot.
By default, this goes from one standard deviation below the observed range
to one standard deviation above the observed range and the observed range
is highlighted on the plot. You could instead choose to provide the
actual observed minimum and maximum, in which case the range of the
observed data is not highlighted in the plot. Provide the range as a vector,
e.g., <code>c(0, 10)</code>.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>The plot title. <code>"Johnson-Neyman plot"</code> by default.</p></dd>


<dt id="arg-y-label">y.label<a class="anchor" aria-label="anchor" href="#arg-y-label"></a></dt>
<dd><p>If you prefer to override the automatic labelling of the
y axis, you can specify your own label here. The y axis represents a
<em>slope</em> so it is recommended that you do not simply give the name of the
predictor variable but instead make clear that it is a slope. By default,
"Slope of [pred]" is used (with whatever <code>pred</code> is).</p></dd>


<dt id="arg-modx-label">modx.label<a class="anchor" aria-label="anchor" href="#arg-modx-label"></a></dt>
<dd><p>If you prefer to override the automatic labelling of
the x axis, you can specify your own label here. By default, the name
<code>modx</code> is used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>bounds</dt>
<dd><p>The two numbers that make up the interval.</p></dd>

<dt>cbands</dt>
<dd><p>A dataframe with predicted values of the predictor's slope
and lower/upper bounds of confidence bands if you would like to make your
own plots</p></dd>

<dt>plot</dt>
<dd><p>The <code>ggplot</code> object used for plotting. You can tweak the
plot like you could any other from <code>ggplot</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The interpretation of the values given by this function is important and not
always immediately intuitive. For an interaction between a predictor variable
and moderator variable, it is often the case that the slope of the predictor
is statistically significant at only some values of the moderator. For
example, perhaps the effect of your predictor is only significant when the
moderator is set at some high value.</p>
<p>The Johnson-Neyman interval provides the two values of the moderator at
which the slope of the predictor goes from non-significant to significant.
Usually, the predictor's slope is only significant <em>outside</em> of the
range given by the function. The output of this function will make it clear
either way.</p>
<p>One weakness of this method of probing interactions is that it is analogous
to making multiple comparisons without any adjustment to the alpha level.
Esarey &amp; Sumner (2017) proposed a method for addressing this, which is
implemented in the <code>interactionTest</code> package. This function implements that
procedure with modifications to the <code>interactionTest</code> code (that package is
not required to use this function). If you set <code>control.fdr = TRUE</code>, an
alternative <em>t</em> statistic will be calculated based on your specified alpha
level and the data. This will always be a more conservative test than when
<code>control.fdr = FALSE</code>. The printed output will report the calculated
critical <em>t</em> statistic.</p>
<p>This technique is not easily ported to 3-way interaction contexts. You could,
however, look at the J-N interval at two different levels of a second
moderator. This does forgo a benefit of the J-N technique, which is not
having to pick arbitrary points. If you want to do this, just use the
<code><a href="sim_slopes.html">sim_slopes</a></code> function's ability to handle 3-way interactions
and request Johnson-Neyman intervals for each.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bauer, D. J., &amp; Curran, P. J. (2005). Probing interactions in fixed and
multilevel regression: Inferential and graphical techniques.
<em>Multivariate Behavioral Research</em>, <em>40</em>(3), 373-400.
<a href="https://doi.org/10.1207/s15327906mbr4003_5" class="external-link">doi:10.1207/s15327906mbr4003_5</a></p>
<p>Esarey, J., &amp; Sumner, J. L. (2017). Marginal effects in interaction models:
Determining and controlling the false positive rate. Comparative Political
Studies, 1–33. Advance online publication.
<a href="https://doi.org/10.1177/0010414017730080" class="external-link">doi:10.1177/0010414017730080</a></p>
<p>Johnson, P.O. &amp; Fay, L.C. (1950). The Johnson-Neyman technique, its theory
and application. <em>Psychometrika</em>, <em>15</em>, 349-367.
<a href="https://doi.org/10.1007/BF02288864" class="external-link">doi:10.1007/BF02288864</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other interaction tools:
<code><a href="probe_interaction.html">probe_interaction</a>()</code>,
<code><a href="sim_margins.html">sim_margins</a>()</code>,
<code><a href="sim_slopes.html">sim_slopes</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jacob Long <a href="mailto:jacob.long@sc.edu">jacob.long@sc.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Using a fitted lm model</span></span></span>
<span class="r-in"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">states</span><span class="op">$</span><span class="va">HSGrad</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">$</span><span class="va">`HS Grad`</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Income</span> <span class="op">~</span> <span class="va">HSGrad</span> <span class="op">+</span> <span class="va">Murder</span><span class="op">*</span><span class="va">Illiteracy</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">states</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">johnson_neyman</span><span class="op">(</span>model <span class="op">=</span> <span class="va">fit</span>, pred <span class="op">=</span> <span class="va">Murder</span>,</span></span>
<span class="r-in"><span>  modx <span class="op">=</span> <span class="va">Illiteracy</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold; text-decoration: underline;">JOHNSON-NEYMAN INTERVAL</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> When Illiteracy is OUTSIDE the interval [0.80, 2.67], the slope of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Murder is p &lt; .05.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Note: The range of observed values of Illiteracy is </span>[0.50, 2.80]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="johnson_neyman-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jacob A. Long.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

